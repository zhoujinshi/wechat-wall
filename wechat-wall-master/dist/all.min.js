define(["config","jquery"],function(n,t){return function(e){var i,c;return{draw:function(n){c=n},start:function(){e.total()<2||i||this.avatar()},end:function(){return e.total()<2||this.randit()},avatar:function(){var n=Math.round(Math.random()*e.total()+.5)-1,t=e.get(n);c(t.nickname,t.avatar),i=setTimeout(arguments.callee,100)},randit:function(){clearTimeout(i),i=null;var n=Math.round(Math.random()*e.total()+.5)-1,t=e.get(n);c(t.nickname,t.avatar),e.addLuckyGuy(t),e.remove(n)},remove:function(n){var t=e.getLuckGuy(n);e.removeLuckGuy(n),e.add(t)},reset:function(){t.each(e.getLuckGuys(),function(n,t){e.add(t)}),e.clearLuckyGuy()}}}}),define(["config","jquery"],function(n,e){return function(){return{fetch:function(t){e.ajax({type:"GET",url:n.backend+"message",dataType:"json",success:function(n){t(n)}})}}}}),define(["config","jquery"],function(n,e){return function(){return{score:function(t){e.ajax({type:"GET",url:n.backend+"shake/score",dataType:"json",success:function(n){t(n)}})},start:function(){e.get(n.backend+"shake/start")},end:function(t){e.ajax({type:"GET",url:n.backend+"shake/end",dataType:"json",success:function(n){t(n)}})}}}}),define(["config","jquery"],function(n,r){return function(){var t=[{nickname:"赵荣",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYdjGKVSqbGQLWF0wGxxS9TggTod5c6ichWE4sicF0Gaia6rQ/"},{nickname:"张楠",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYf43yjhA9UiboQSvq9YvrSic6fgh9unjj2zgAq4u3kkibuUw/"},{nickname:"陆章其",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYf43yjhA9UiboQSvq9YvrSic6mibjJ61wJZ5jFyLKe3aKSNw/"},{nickname:"尹振宇",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYdUib6tcics38F5gbiaLCgqY31AEicuic8WP8tFzD0Z045MAAQ/"},{nickname:"王海滨",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYfZ6lO9OiaJziczsO8ibl9aJTxl2MXDAHUeOmO124rib4zlbg/"},{nickname:"钟成",avatar:""},{nickname:"李知远",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYclIpDbMrVTgD06G9yGffYtrgNAtCMWp6sDLekyFxNX9w/"},{nickname:"顾黎明",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYf43yjhA9UiboQSvq9YvrSic6j5kSbcML1Riay5cKx7lmNGA/"},{nickname:"王东",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYf43yjhA9UiboQSvq9YvrSic6mq6Sd51dLDoLE661xnndbA/"},{nickname:"黄俊鑫",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYf43yjhA9UiboQSvq9YvrSic6kMfxnMRN9rhr9oicUoJEOUQ/"},{nickname:"张航",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYdUib6tcics38F5gbiaLCgqY31JIic3fkq3xL1rcQKkTnZsqw/"},{nickname:"宋振豪",avatar:""},{nickname:"李豪杰",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYdUib6tcics38F5gbiaLCgqY31VuibCpW2BBX2QiclPahKojsg/"},{nickname:"李鑫凌",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYcCflgLqDiaTwJX9prg7CDvjJEUqXtenFDfsCYxkAkOPhQ/"},{nickname:"黄明",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYfZ6lO9OiaJziczsO8ibl9aJTxKlibqheh1wPUK5WDtHuibXZg/"},{nickname:"范旭东",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYcCflgLqDiaTwJX9prg7CDvjiaicU0qJ4wOkS4CORZed0DoQ/"},{nickname:"徐海东",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYdUib6tcics38F5gbiaLCgqY31MV3IgYHqicONFoRGaqoDicbg/"},{nickname:"陈崎峰",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYf43yjhA9UiboQSvq9YvrSic6nUH6LdIV9K0Mlh9cQEBQLw/"},{nickname:"彭煕",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYfZ6lO9OiaJziczsO8ibl9aJTxpw7OzBibNP0r6hticibYMSY4w/"},{nickname:"刘冰",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYdUib6tcics38F5gbiaLCgqY315ORiaxficP0bdV7zUh6AEtSg/"},{nickname:"齐闻",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYclIpDbMrVTgD06G9yGffYtia9X8GnSeTojtrXEG0LxW1Q/"},{nickname:"吴品彦",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYf43yjhA9UiboQSvq9YvrSic6XcNzicCHrrtru6XicwYKQTSA/"},{nickname:"刘霖",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYf43yjhA9UiboQSvq9YvrSic6nia2S1RicmbV3uVaeJPYstaA/"},{nickname:"戢汉邦",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYdUib6tcics38F5gbiaLCgqY31xFqhaZlyw7dhDbgwibLWQnQ/"},{nickname:"王艺萌",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYfZ6lO9OiaJziczsO8ibl9aJTxKjlzZlpzsBDrCYZx7yPQsQ/"},{nickname:"宋泽明",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYclIpDbMrVTgD06G9yGffYtVibjmYk9vABF1gu1ichRHLpA/"},{nickname:"孙健",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYdUib6tcics38F5gbiaLCgqY31EC1kDrSicTAV8ycNLYianVBQ/"},{nickname:"张培培",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYdUib6tcics38F5gbiaLCgqY31rSKGCr3yc3Jzx7ZjoVN62g/"},{nickname:"曹晓明",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYfZ6lO9OiaJziczsO8ibl9aJTxvI12BrMYo3lYDpaT3iaKufQ/"},{nickname:"刘皋",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYf43yjhA9UiboQSvq9YvrSic6NZ5oJAVy2WaKibnOgYGkTow/"},{nickname:"季云培",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYf43yjhA9UiboQSvq9YvrSic6fyeheaficteHXQYfYagJJGA/"},{nickname:"童梅",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYf43yjhA9UiboQSvq9YvrSic6FvsicvdRcslTm6MJuxdmpiaA/"},{nickname:"施家奇",avatar:""},{nickname:"王晓迪",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYclIpDbMrVTgD06G9yGffYtbAY5GzGZgyHWr0MNuKguhQ/"},{nickname:"皇甫绍钧",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYclIpDbMrVTgD06G9yGffYtBcssicCuHfINKb3ezJ3sYYA/"},{nickname:"李坤",avatar:"http://shp.qpic.cn/bizmp/EIxjZcrBHYcCflgLqDiaTwJX9prg7CDvjehxUEcw7ic0AuajjLGzMhvw/"}];function c(n){return JSON.parse(window.localStorage.getItem(n)||"[]")}function a(n,t){window.localStorage.setItem(n,JSON.stringify(t))}return r.each(t,function(n,t){t.id=n}),{clearLuckyGuy:function(){a("award",[])},addLuckyGuy:function(n){var t=c("award")||[];t.push(n),a("award",t)},getLuckGuy:function(e){var n=c("award")||[],i=null;return r.each(n,function(n,t){t.id!=e||(i=t)}),i},getLuckGuys:function(){return c("award")},removeLuckGuy:function(e){var i=c("award")||[];r.each(i,function(n,t){t&&t.id==e&&i.splice(n,1)}),a("award",i)},all:function(){return t},add:function(n){this.maxId||(this.maxId=t.length),n.id=this.maxId++,t.push(n)},get:function(n){return t[n]},remove:function(n){t.splice(n,1)},total:function(){return t.length}}}}),define(["models/user","models/bingo","models/message","lottery/views/appView","wall/views/appView","../utils","config","jquery"],function(n,t,e,i,c,a,r,s){var o=s(".container"),p=o.find(".bingo .guy img"),u=o.find(".bingo .guy .nickname"),l=o.find(".result ul"),m=o.find(".users ul"),d=o.find(".header .hudong"),h=new n;s.each(h.getLuckGuys(),function(n,e){s.each(h.all(),function(n,t){t&&e.id==t.id&&h.remove(n)})});var f=new c(d),b=new e;a.thread.run({callback:function(){b.fetch(f.drawOne)},interval:r.wall.interval});var g=new t(h,o);function v(){m.html(""),l.html(""),s.each(h.getLuckGuys(),function(n,t){l.append(s("<li>").append('<div class="row"><div class="name col-md-10">'+t.nickname+'</div><div class="col-md-2"><a href="#" data-id="'+t.id+'"> <i class="fa fa-remove"> </div></i></a>'))}),s(".result li a").click(function(){g.remove(parseInt(s(this).data("id"))),s(this).parent().remove(),v()}),s.each(h.all(),function(n,t){m.append(s("<li>").append('<img src="'+t.avatar+'" height="15px"/><span class="name">'+t.nickname+'</span><a href="#" data-id="'+n+'"> <i class="fa fa-remove"> </i></a>'))}),s(".users li a").click(function(){h.remove(parseInt(s(this).data("id"))),s(this).parent().remove(),v()})}g.draw(function(n,t){p.attr("src",t),u.html(n)});var j=s(".bingo button.start"),w=s(".bingo button.end");w.hide(),j.click(function(){g.start(),j.toggle(),w.toggle()}),w.click(function(){g.end(),v(),j.toggle(),w.toggle()}),s(".result button.reset").click(function(){g.reset(),v()}),s(".users a.add").click(function(){var e=prompt("输入姓名");if(e){var i={nickname:e,avatar:"avatar/default.png"};s.each(h.all(),function(n,t){t.nickname!=e||(i.avatar=t.avatar)}),h.add(i)}v()}),v()}),require.config({baseUrl:".",map:{"*":{text:"bower_components/text/text",css:"bower_components/require-css/css"}},urlArgs:"bust="+(new Date).getTime(),paths:{jquery:"bower_components/jquery/dist/jquery.min",underscore:"bower_components/underscore/underscore",bootstrap:"bower_components/bootstrap/dist/js/bootstrap.min","underscore.string":"bower_components/underscore.string/lib/underscore.string",lottery:"js/lottery",wall:"js/wall",models:"js/models",utils:"js/utils",config:"js/config",localconfig:"js/localconfig",text:"bower_components/text/text",css:"bower_components/require-css/css"},shim:{"underscore.string":{deps:["underscore"]}}}),require(["lottery/app"],function(){}),define(["models/shake","shake/views/scoreView","shake/views/userView","../utils","config","jquery"],function(n,t,e,i,c,a){var r=a(".container"),s=r.find(".users ul"),o=r.find(".score ul"),p=r.find(".timer"),u=r.find(".timer2"),l=r.find(".bg"),m=new n,d=new e(s),h=new t(o);i.thread.run({callback:function(){m.score(d.draw)},interval:2e3});var f=a(".action button.start");f.click(function(){s.show(),h.clear(),f.toggle(),l.show(),i.countDown.run({finished:function(){s.hide(),l.toggle(),p.empty(),m.start();var n=i.thread;n.run({callback:function(){m.score(h.draw)},interval:1e3}),i.countDown.run({finished:function(){l.hide(),u.empty(),p.empty(),n.stop(),m.end(h.draw),f.toggle()},every:function(n){n<7?(l.show(),u.html(""),p.html("结束倒计时: "+n)):u.html("结束倒计时: "+n)},period:c.shake.period})},every:function(n){p.html(n)},period:10})})}),require.config({baseUrl:".",map:{"*":{text:"bower_components/text/text",css:"bower_components/require-css/css"}},urlArgs:"bust="+(new Date).getTime(),paths:{jquery:"bower_components/jquery/dist/jquery.min",underscore:"bower_components/underscore/underscore",bootstrap:"bower_components/bootstrap/dist/js/bootstrap.min","underscore.string":"bower_components/underscore.string/lib/underscore.string",shake:"js/shake",models:"js/models",utils:"js/utils",config:"js/config",localconfig:"js/localconfig",text:"bower_components/text/text",css:"bower_components/require-css/css"},shim:{"underscore.string":{deps:["underscore"]}}}),require(["shake/app"],function(){}),define(["models/message","wall/views/appView","../utils","config","jquery"],function(n,t,e,i,c){var a=c(".container").find(".messages ul"),r=new n,s=new t(a);e.thread.run({callback:function(){r.fetch(s.draw)},interval:i.wall.interval})}),require.config({baseUrl:".",map:{"*":{text:"bower_components/text/text",css:"bower_components/require-css/css"}},urlArgs:"bust="+(new Date).getTime(),paths:{jquery:"bower_components/jquery/dist/jquery.min",underscore:"bower_components/underscore/underscore",bootstrap:"bower_components/bootstrap/dist/js/bootstrap.min","underscore.string":"bower_components/underscore.string/lib/underscore.string",wall:"js/wall",models:"js/models",utils:"js/utils",config:"js/config",localconfig:"js/localconfig",text:"bower_components/text/text",css:"bower_components/require-css/css"},shim:{"underscore.string":{deps:["underscore"]}}}),require(["wall/app"],function(){});